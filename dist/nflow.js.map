{"version":3,"sources":["webpack:///webpack/bootstrap 9a7aee80b8167db6b2f8","webpack:///./src/index.js","webpack:///./src/nflow.js","webpack:///./src/factory.js","webpack:///./src/behaviours/index.js","webpack:///./src/behaviours/cancellable.js","webpack:///./src/consts.js","webpack:///./src/utils.js","webpack:///./src/logger.js","webpack:///./src/behaviours/connect.js","webpack:///./src/behaviours/create.js","webpack:///./src/behaviours/emit.js","webpack:///./src/routes/index.js","webpack:///./src/routes/upstream.js","webpack:///./src/routes/current.js","webpack:///./src/routes/downstream.js","webpack:///./src/routes/default.js","webpack:///./src/behaviours/identify.js","webpack:///./src/behaviours/listen.js","webpack:///./src/behaviours/loggable.js","webpack:///./src/behaviours/stateful.js","webpack:///./src/behaviours/get.js","webpack:///./src/behaviours/stats.js","webpack:///./src/behaviours/disposable.js"],"names":[],"mappings":"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","file":"nflow.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"http://localhost:5000/dist/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 9a7aee80b8167db6b2f8\n **/","import nflow from './nflow'\nif (global) global.nflow = global.nFlow = nflow // nFlow is now deprecated\nmodule.exports = nflow\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/index.js\n **/","import factory from './factory'\nimport {DEFAULTS} from './consts'\nimport logger from './logger'\n\nvar root = factory(DEFAULTS, \"flow\", [])\nlogger.init(root)\nexport default root\n\n\n/** WEBPACK FOOTER **\n ** ./src/nflow.js\n **/","import behaviours from './behaviours'\nexport default (defaults, name, data)=>{\n  var flow = defaults.factory()\n\n  defaults\n    .behaviours\n    .forEach((d)=>{\n      behaviours[d](flow, defaults, name, data)\n  })\n  return flow\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/factory.js\n **/","\nimport cancellable from './cancellable'\nimport connect from './connect'\nimport create from './create'\nimport emit from './emit'\nimport identify from './identify'\nimport listen from './listen'\nimport loggable from './loggable'\nimport stateful from './stateful'\nimport get from './get'\nimport stats from './stats'\nimport disposable from './disposable'\n\nexport default {\n  cancellable,\n  connect,\n  create,\n  disposable,\n  emit,\n  identify,\n  listen,\n  loggable,\n  stateful,\n  get,\n  stats\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/behaviours/index.js\n **/","import { DEFAULTS\n       , ERRORS\n       , STATUS\n       , DIRECTION\n       , DIRECTION_BITMASK\n       , UNSET } from '../consts'\nimport {assert, detach, dispatchInternalEvent} from '../utils'\n\nexport default (flow, defaults, name)=>{\n  \n  flow.cancel = (...args) => {\n    assert(args.length\n         , ERRORS.invalidCancelArgs)\n    let previousValue = flow.cancel.value\n    flow.cancel.value = true\n    dispatchInternalEvent(flow, 'cancel', true, previousValue)\n    return flow\n  }\n  flow.cancel.value = false\n\n  flow.isCancelled = () => {\n    return [flow]\n      .concat(flow.parents())\n      .some(e=>e.status() == STATUS.CANCELLED\n          || e.status() == STATUS.DISPOSED\n        )\n  }\n\n  flow.stopPropagation = (direction=UNSET) => {\n    direction!==UNSET && assert(!DIRECTION[direction.toUpperCase()]\n         , ERRORS.invalidStopPropagationArgs)\n\n    if (direction==UNSET){\n      flow.status.value = STATUS.STOPPED\n      flow.stopPropagation.value = true;\n      flow.stopPropagation.modifiers[flow.target.guid] = -1 //bitmask fill\n      dispatchInternalEvent(flow, 'propagationStopped', true)\n    }\n    else {\n      let d = DIRECTION[direction.toUpperCase()]\n      dispatchInternalEvent(flow, 'propagationAugmented', {\n        direction:d,\n        target: flow.target.toObj('name', 'guid')\n      })\n      flow.stopPropagation.modifiers[flow.target.guid.value] |= DIRECTION_BITMASK[d]\n    }\n    return flow\n  }\n\n  flow.stopPropagation.value = false\n  flow.stopPropagation.modifiers = {}\n  createStopPropagationModifiers(flow)\n\n\n  flow.propagationStopped = () => {\n    \n    return flow.stopPropagation.value\n  }\n\n}\n/** \n *  create directional (eg. `flow.stopPropagation.dowsntream(...)`) API\n */\nfunction createStopPropagationModifiers(flow){\n  Object.keys(DIRECTION)\n    .forEach(direction=>{\n      flow.stopPropagation[direction] \n        = flow.stopPropagation[direction.toLowerCase()]\n        = ()=>{\n          return flow.stopPropagation(direction)\n      }\n    })\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/behaviours/cancellable.js\n **/","/**\n *  consts\n */\n\nexport const UNSET = {}\nexport const DIRECTION = {\n  CURRENT: \"CURRENT\",\n  NONE: \"CURRENT\", // deprecated\n  DEFAULT: \"DEFAULT\",\n  UPSTREAM: \"UPSTREAM\",\n  DOWNSTREAM: \"DOWNSTREAM\"\n}\n\nexport const DIRECTION_BITMASK = {\n  CURRENT:    1<<0,\n  NONE:       1<<0, // deprecated\n  DEFAULT:    1<<1,\n  UPSTREAM:   1<<2,\n  DOWNSTREAM: 1<<3\n}\n\nexport const STATUS = {\n  IDLE: \"IDLE\",\n  FLOWING: \"FLOWING\",\n  STOPPED: \"STOPPED\",\n  COMPLETED: \"COMPLETED\",\n  CANCELLED: \"CANCELLED\",\n  DISPOSED: \"DISPOSED\"\n}\n\nexport const DEFAULTS = {\n  factory: ()=>({}),\n  behaviours:[\n    'identify',\n    'stateful',\n    'connect',\n    'create',\n    'disposable',\n    'emit',\n    'listen',\n    'cancellable',\n    'loggable',\n    'stats'\n  ],\n  direction: DIRECTION.DEFAULT\n}\nexport const ERRORS = {\n  invalidGuid:     'Invalid Argument. Guid-s are immutable. Please use the .name() API to change the name of a flow object.'\n, invalidChildren: 'Invalid Argument. Please use child.parent(parent) to re-parent flow objects.'\n, invalidListener: 'Invalid Arguments. Please use .on(\"foo\", handler) to create a listener.'\n, invalidListenerType: 'Invalid Listener function. Expected a function, got: %s'\n, invalidEventName:'Invalid Arguments. Please use .emit(\"foo\", payload) to emit a flow event.'\n, invalidName:'Invalid flow Name. Expected a String value, got: %s'\n, invalidParent:'Invalid flow parent object. Expected a flow instance, got: %s'\n, invalidParents:'Invalid Argument. Please use the child.parent(parent) API to re-parent flow objects.'\n, invalidStatus:'Invalid Argument. The .status() API is read only'\n, invalidDisposeArgs:'Invalid Argument. The .dispose() API requires no parameters'\n, invalidCancelArgs:'Invalid Argument. The .cancel() API requires no parameters'\n, invalidStopPropagationArgs:'Invalid Argument. The .stopPropagation(direction) API requires either no parameters or a valid flow direction(eg. flow.direction.UPSTREAM)'\n, invalidRoot:'Invalid Argument. The .parents.root() API is read only'\n, invalidStatsArgs:'Invalid Argument. The .stats() API requires an object'\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/consts.js\n **/","import factory from './factory'\nimport { DEFAULTS\n       , ERRORS\n       , STATUS\n       , DIRECTION\n       , UNSET } from './consts'\nimport logger from './logger'\n\nconst RECURSION_LIMIT = 1024;\n/**\n *  utils\n */\nexport function assert(condition, error, val){\n  if (condition) {\n    throw new Error(error\n      .replace(\"%s\", val))\n  }\n  return condition\n}\n\nexport function isFlow(flow){\n  return flow\n    && flow.name\n    && flow.name.isFlow\n}\n\nexport function isInternal(flow){\n  return flow\n    && flow.name\n    && flow.name.isInternal\n}\n\nexport function detach(flow){\n  flow.parent()\n    && flow.parent().children.detach(flow)\n}\n\nexport function isDetached(flow){\n  return !flow.parent()\n    || !flow.parent().children.has(flow)\n}\n\nexport function flatten(array){\n  return [].concat.apply([], array);\n}\n\nexport function merge(source, target){\n  Object.keys(source).forEach(key=>{\n    target[key]= source[key]\n  })\n}\n\nexport function dispatchInternalEvent(flow, name, newData, oldData){\n  if (isIgnored(flow)) return\n  var e= factory(DEFAULTS, \"flow.\"+name)\n  e.name.isInternal = true\n  e.data.value = [newData, oldData]\n  e.direction.value= DIRECTION.CURRENT\n  e.parent.value = flow\n  e.emit()\n  e.data.value = [flow, newData, oldData]\n  e.direction.value= DIRECTION.UPSTREAM\n  e.name.value=\"flow.children.\"+name\n  e.emit()\n\n  e.direction.value= DIRECTION.DOWNSTREAM\n  e.name.value=\"flow.parent.\"+name\n  e.emit()\n\n  logger.log(flow, name, newData, oldData)\n}\n\nexport const serialise = o=>JSON.stringify(o, replacer())\n\nfunction isIgnored(flow){\n  return [flow]\n    .concat(flow.parents())\n    .some(e=>e.stats.value.ignore)\n}\n\nfunction replacer() {\n  let stack = []\n  , r = 0\n  , i\n    return function replacer(key, value) {\n      if (key === \"\") {\n        stack = [];\n        r = 0;\n      }\n      switch(typeof value) {\n        case \"function\":\n          return \"\".concat(\n            \"function \",\n            value.name || \"anonymous\",\n            \"(\",\n              Array(value.length + 1).join(\",arg\").slice(1),\n            \"){...}\"\n          );\n        case \"boolean\":\n        case \"number\":\n        case \"string\":\n          return value;\n        default:\n          if (!value || RECURSION_LIMIT < ++r) return undefined;\n          i = stack.indexOf(value);\n          if (i < 0) return stack.push(value) && value;\n          return \"*Recursive\" + i;\n      }\n    };\n  }\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/utils.js\n **/","import {isInternal, serialise} from './utils'\nimport { DEFAULTS\n       , ERRORS\n       , STATUS\n       , DIRECTION\n       , UNSET } from './consts'\nimport factory from './factory'\n\nvar loggers = []\n\nfunction log(flow, name, newData, oldData){\n  if (!isInternal(flow)){\n    loggers.forEach(f=>{\n      f.isRemote\n        ? f.logger(remoteLog(flow, name, newData, oldData), flow)\n        : f.logger(flow, name, newData, oldData)\n    })\n    debug(flow, name, newData, oldData)\n  }\n}\n\nfunction debug(flow, name, newData, oldData){\n  typeof global !== 'undefined' &&\n  global.__nflow_devtools_hook__ &&\n  global.__nflow_devtools_hook__(\n    remoteLog(flow, name, newData, oldData), flow)\n}\n\n/**\n *  Converts a local log message(direct references) to a remote one(unmarshallable)\n */\nfunction remoteLog(flow, name, d, d0){\n  let o = {\n      flow: flow.toObj('name','guid'),\n      action: name\n    }\n  let props = ['name', 'guid']\n  if (name=='start') props.push('version', 'status')\n  if (name=='cancel') props.push('status')\n  if (name=='create') props.push('status')\n  if (name=='create' && d.data()!==undefined) props.push('data')\n  if (name=='emitted' ) props.push('recipients')\n  let newData = (d && d.toObj? d.toObj(...props):serialise(d))\n  let oldData = (d0 && d0.toObj? d0.toObj(...props):serialise(d0))\n  if (newData!==undefined) o.d=newData\n  if (oldData!==undefined) o.d0=oldData\n  return o\n}\n\nfunction init(flow){\n  flow.enableDevTools = (enabled=true)=>{\n    console.warn('flow.enableDevtools() is now deprecated. nflow-devtools will automatically start logging when Chrome devtools is open')\n    return flow\n  }\n\n  flow.logger = (logger=UNSET, isRemote=false) => {\n    if (logger===UNSET) return loggers\n    else loggers.push({logger,isRemote})\n    return flow\n  }\n  flow.logger.reset = ()=>loggers=[];\n  debug(flow, 'start', flow)\n}\n\nexport default {\n  init\n, log\n  }\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/logger.js\n **/","import {assert, detach, dispatchInternalEvent, isFlow} from '../utils'\nimport { ERRORS, UNSET } from '../consts'\n\nexport default (flow)=>{\n  \n  /**\n   *  .children() API\n   */\n  flow.children = (...args) => {\n    assert(args.length, ERRORS.invalidChildren)\n    return flow.children.value.concat()\n  }\n  flow.children.value = []\n\n  flow.children.has = (matcher, recursive)=>flow.children.find(matcher, recursive)!=null\n  flow.children.find = (matcher, recursive)=>flow.children.findAll(matcher, recursive).pop()\n  flow.children.findAll = (matcher, recursive)=>{\n\n    var filter = matcher;\n    if (matcher==null) return []\n    if (typeof(matcher)==\"string\") filter = f=>f.name()==matcher\n    else if (isFlow(matcher)) filter = f=>f==matcher\n    var children = recursive \n      ? flow.children.all()\n      : flow.children()\n    \n    return children.filter(filter)\n  }\n\n  flow.get = flow.children.find\n  flow.getAll = flow.children.find\n\n  /**\n   *  return all children recursively\n   */\n  flow.children.all = (...args)=>{\n    assert(args.length, ERRORS.invalidChildren)\n    var childMap = {}\n    return getChildren(flow)\n\n    function getChildren(flow){\n      if (childMap[flow.guid()]) return [];\n      childMap[flow.guid()] = true\n      var c = flow.children.value\n      var gc = flow.children.value.map(getChildren)\n      \n      return c.concat.apply(c, gc);\n    }\n\n  }\n\n  /**\n   *  .parent() API\n   */\n  flow.parent = (...parentArgs) => {\n    if (!parentArgs.length) return flow.parent.value;\n    var parent = parentArgs[0]\n    parent && assert(!isFlow(parent), ERRORS.invalidParent, parent)\n    var previousParent = flow.parent() \n    detach(flow)\n    dispatchInternalEvent(flow, 'parent', parent, previousParent)\n    attach(parent)\n    dispatchInternalEvent(flow, 'parented', parent, previousParent)\n    return flow\n  }\n\n  flow.parents = (...args)=>{\n    assert(args.length, ERRORS.invalidParents)\n    var parentMap = {}\n    var parents = []\n    var p = flow.parent()\n    while (p && !parentMap[p.guid()]){\n      parents.push(p)\n      parentMap[p.guid()]=true\n      p = p.parent()\n    }\n    return parents \n  }\n\n  flow.parents.find = (matcher)=>{\n    if (matcher==null) return null\n    var filter = matcher\n    if (typeof(matcher)==\"string\") filter = f=>f.name()==matcher\n    else if (isFlow(matcher)) filter = f=>f==matcher\n\n    return flow.parents()\n      .filter(filter)\n      .pop()\n  }\n  flow.parents.has = (matcher)=>(\n    !!flow.parents.find(matcher)\n  )\n\n  flow.parents.root = (...args)=>{\n    assert(args.length, ERRORS.invalidRoot)\n    return flow\n      .parents()\n      .pop()\n  }\n\n  flow.children.detach = (child)=>{\n    flow.children.value = \n      flow.children.value\n        .filter(f=>f!=child)\n  }\n  \n  flow.target = flow\n\n  function attach(parent) {\n    parent && parent.children.value.push(flow)\n    flow.parent.value = parent\n  }\n\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/behaviours/connect.js\n **/","import factory from '../factory'\nimport logger from '../logger'\nimport {assert, dispatchInternalEvent} from '../utils'\nimport { DEFAULTS\n       , ERRORS\n       , STATUS\n       , DIRECTION\n       , UNSET } from '../consts'\n\n\nexport default (flow, defaults)=>{\n\n  flow.create = (name, ...data) => {\n    var instance = factory(flow.create.defaults, name, data)\n    instance.parent.value = flow\n    flow.children.value.push(instance)\n    inheritStats(instance)\n    dispatchInternalEvent(flow, 'create', instance)\n\n    return instance\n  }\n\n  flow.create.defaults = {\n    factory: defaults.factory,\n    behaviours: defaults.behaviours.concat(),\n    direction: defaults.direction\n  }\n\n  flow.dispose = (...args) => {\n    assert(args.length\n         , ERRORS.invalidDisposeArgs)\n    if (flow.dispose.value == true) return;\n\n    dispatchInternalEvent(flow, 'dispose', true)\n    flow.parent(null)\n    flow.dispose.value = true\n    flow.on.listenerMap = {}\n\n    //recursively dispose all downstream nodes\n    flow.children().forEach(f=>f.dispose())\n    return flow\n  }\n  flow.dispose.value = false\n}\n\nfunction inheritStats(flow){\n  let p = flow.parent()\n  if (p) {\n    let defaults = p.stats.value.defaults||{}\n    let nodeDefaults = defaults[flow.name.value]||{}\n    flow.stats.value = {...nodeDefaults}\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/behaviours/create.js\n **/","import { DEFAULTS\n       , ERRORS\n       , STATUS\n       , DIRECTION\n       , UNSET } from '../consts'\nimport factory from '../factory'\nimport {merge, detach, flatten, assert, isDetached, isFlow, dispatchInternalEvent} from '../utils'\nimport logger from '../logger'\nimport routes from '../routes'\n\nvar log = logger.log\nexport default (flow)=>{\n  \n  flow.status = (...args) => {\n    assert(args.length\n         , ERRORS.invalidStatus)\n    if (flow.cancel.value) return STATUS.CANCELLED\n    if (flow.dispose.value) return STATUS.DISPOSED\n    return flow.status.value\n  }\n  flow.status.value = STATUS.IDLE\n  merge(STATUS, flow.status)\n  \n\n  flow.direction = (direction=UNSET) => {\n    if (direction===UNSET) return flow.direction.value\n    let oldDirection = flow.direction.value\n    flow.direction.value = direction\n    dispatchInternalEvent(flow, 'direction', direction, oldDirection)\n    return flow\n  }\n  flow.direction.value = flow.create.defaults.direction\n  merge(DIRECTION, flow.direction)\n\n  flow.emit = (name=UNSET, ...args)=>{\n    return emit(name, args)\n  }\n  createEmitAPI(flow)\n\n  function emit(name=UNSET, args, direction){\n    if (name==UNSET) {\n      // emit current flow object\n      detach(flow)\n      direction && flow.direction(direction)\n      !flow.name.isInternal && dispatchInternalEvent(flow.parent(), 'emit', flow)\n      flow.emit.route(flow)\n      !flow.name.isInternal && dispatchInternalEvent(flow.parent(), 'emitted', flow)\n      return flow\n    }\n    if (isFlow(name)) {\n\n      //1. reparent the passed in flow object where it's emitted from\n      name.parent(flow)\n      //2.  emit the passed in flow object\n      detach(name)\n      direction && name.direction(direction)\n      name.data(...args)\n      dispatchInternalEvent(flow, 'emit', name)\n      flow.emit.route(name)\n      dispatchInternalEvent(flow, 'emitted', name)\n      return flow\n    }\n\n    // create and emit a new event\n    assert(typeof(name)!='string'\n      , ERRORS.invalidEventName)\n    \n\n    var event = flow.create(name, ...args)    \n    detach(event)\n    if (direction) event.direction.value = direction\n    dispatchInternalEvent(flow, 'emit', event)\n    flow.emit.route(event)\n    dispatchInternalEvent(flow, 'emitted', event)\n    return event\n  }\n  \n  flow.emit.route = (flow)=>{\n    // 2. reset status\n    flow.emit.recipients = []\n    flow.emit.recipientsMap = {}\n    \n    flow.status.value = STATUS.FLOWING;\n    \n    // only keep unique recipients\n    flow.emit.targets = flow.emit.route[flow.direction()](flow)\n      .filter(f=>!flow.emit.recipientsMap[f.flow.guid()])\n\n    while (flow.emit.targets.length){\n      var destination = flow.emit.targets.shift()\n      if (flow.isCancelled()) break;\n      if (flow.propagationStopped()) break;\n      if (destination.flow.isCancelled()) continue;\n      notify(flow, destination)\n    }\n    if (!flow.isCancelled() && !flow.propagationStopped()) {\n      flow.status.value = STATUS.COMPLETED\n    }\n  }\n  \n  Object.keys(routes).forEach(route=>{\n    flow.emit.route[route] \n      = flow.emit.route[route.toUpperCase()] \n      = routes[route]\n  })\n  \n  function notify(flow, currentNode){\n    //if (unreachable(flow, currentNode)) return;\n    let result = currentNode.flow.on.notifyListeners(flow)\n    if (result){\n      result.route = currentNode.route\n      result.direction = flow.direction()\n      flow.emit.recipientsMap[currentNode.flow.guid()] = flow.direction()\n      flow.emit.recipients.push(result)\n      \n    }\n  }\n\n  /** \n   *  create directional (eg. `flow.emit.dowsntream(...)`) API\n   */\nfunction createEmitAPI(flow){\n  Object.keys(DIRECTION)\n    .forEach(direction=>{\n      flow.emit[direction] \n        = flow.emit[direction.toLowerCase()]\n        = (name, ...args)=>{\n        return emit(name,args, direction)\n      }\n    })\n  }\n\n}\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/behaviours/emit.js\n **/","import upstream from  './upstream'\nimport current from  './current'\nimport downstream from  './downstream'\nimport _default from  './default'\n\nexport default {\n  upstream,\n  downstream,\n  none:current, // deprecated\n  current,\n  \"default\": _default // IE8 compatibility fix\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/routes/index.js\n **/","import {DIRECTION} from '../consts'\n/**\n *  returns: all parent nodes\n */\nexport default (flow)=>{\n  return [flow]\n    .concat(flow.parents())\n    .map((flow,i,arr)=>({\n      flow,\n      route: arr.slice(0,i+1)\n        .map(f=>({\n          flow:f,\n          direction: DIRECTION.UPSTREAM\n        }))\n    }))\n}\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/routes/upstream.js\n **/","import {DIRECTION} from '../consts'\n/**\n *  returns: only itself and the node emitting it\n */\nexport default (flow)=>(\n  [flow]\n    .concat(flow.parent())\n    .map((flow,i,arr)=>({\n      flow,\n      route: arr\n        .slice(0,i+1)\n        .map((f,i)=>({\n          flow:f,\n          direction: i?DIRECTION.UPSTREAM:DIRECTION.CURRENT\n        }))\n    }))\n)\n\n\n/** WEBPACK FOOTER **\n ** ./src/routes/current.js\n **/","import {DIRECTION} from '../consts'\n\nexport default (flow)=>{\n  let visitedNodesMap = {}\n  let parent = flow.parent()\n  let dir = f=>{\n    if (f===flow) return DIRECTION.CURRENT\n    if (f===parent) return DIRECTION.UPSTREAM\n    return DIRECTION.DOWNSTREAM\n  }\n  let route = getChildren(flow, [])\n    .concat(getChildren(flow.parent()\n      ,[{flow:flow, direction: dir(flow)}]))\n  \n  return route;\n  function getChildren(flow, route){\n    if (visitedNodesMap[flow.guid()]) return []\n    visitedNodesMap[flow.guid()] = true\n    route = route.concat([{flow:flow, direction: dir(flow)}])\n    var nodes = [{ flow, route }]\n    flow.children()\n      .forEach(f=>nodes = nodes.concat(getChildren(f,route)))\n    return nodes\n  }\n\n\n}\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/routes/downstream.js\n **/","import {isDetached} from '../utils'\nimport {DIRECTION} from '../consts'\n\nexport default (flow)=>{\n  var visitedNodesMap = {}\n  var route = []\n  var parents = [flow].concat(flow.parents())\n    .map((flow,i,arr)=>({\n      flow,\n      route: arr.slice(0,i+1)\n        .map(f=>({\n          flow:f,\n          direction: DIRECTION.UPSTREAM\n        }))\n    }))\n  \n  parents.forEach(f=>{\n      // traverse downstream on detached nodes:\n      visitedNodesMap[f.flow.guid()] = true\n      route.push(f)\n\n      if (isDetached(f.flow)) {\n        route = route.concat(getChildren(f.flow, f.route))\n      }\n    })\n  return route;\n\n  function getChildren(flow, route){\n    var visited = (visitedNodesMap[flow.guid()])\n    visitedNodesMap[flow.guid()] = true\n    //route = route\n    var nodes = visited? []:[{ flow, route }]\n    flow.children()\n      .forEach(f=>nodes = nodes.concat(getChildren(f,route\n        .concat([{flow:f, direction: DIRECTION.DOWNSTREAM}]))))\n    return nodes\n  }\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/routes/default.js\n **/","import { DEFAULTS\n       , ERRORS\n       , STATUS\n       , DIRECTION\n       , UNSET } from '../consts'\n\nimport logger from '../logger'\nimport {assert, dispatchInternalEvent} from '../utils'\n\nvar guid = 0\nexport default (flow, defaults, name)=>{\n\n  flow.guid = (...args) => {\n    assert(args.length\n         , ERRORS.invalidGuid)\n    return flow.guid.value\n  }\n  flow.guid.value = createGuid()\n\n  flow.name = (name=UNSET) => {\n    if (name===UNSET) return flow.name.value\n    assert(typeof(name)!=\"string\"\n         , ERRORS.invalidName, name)\n    var previousName = flow.name.value\n    flow.name.value = name\n    dispatchInternalEvent(flow, 'name', name, previousName)\n    return flow\n  }\n  flow.name.value = name || ''\n  flow.name.isFlow = true\n  flow.name.isInternal = false\n\n  flow.call = (...functions)=>{\n    functions\n      .filter(f=>typeof(f)=='function')\n      .forEach(f=>f.call(flow,flow))\n    return flow\n  }\n\n}\n\nfunction createGuid(){\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'\n    .replace(/[xy]/g, function(c) {\n      var r = Math.random()*16|0, v = c == 'x' ? r : (r&0x3|0x8);\n      return v.toString(16);\n    });\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/behaviours/identify.js\n **/","import { ERRORS, UNSET, STATUS, DIRECTION_BITMASK } from '../consts'\nimport {assert, dispatchInternalEvent} from '../utils'\nimport logger from '../logger'\n\nexport default (flow)=>{\n  flow.on = (name=UNSET, ...args) => {\n    if (name==UNSET) return flow.on.listenerMap //TODO clone this!\n    assert(typeof(name)!='string'\n      , ERRORS.invalidListener)\n    \n    if (!args.length) {\n      return flow.on.listenerMap[name]\n    }\n\n    if (args.length==1 && args[0]==null) {\n      dispatchInternalEvent(flow, 'listenerRemoved', {name})\n      delete flow.on.listenerMap[name]\n      return flow;\n    }\n    var oldListeners = flow.on.listenerMap[name]\n    flow.on.listenerMap[name] = args\n      .filter(l=>!assert(typeof(l)!='function'\n        , ERRORS.invalidListenerType, typeof(l)+\": \"+l)\n      )\n    dispatchInternalEvent(flow, oldListeners\n      ? 'listenerChanged'\n      : 'listenerAdded'\n      , {name, handlers:args.map( d=>d.name||'function' )})\n    return flow\n  }\n  flow.on.listenerMap = {};\n\n  flow.on.notifyListeners = (event)=>{\n    if (flow.on.listenerMap[event.name()]) {\n      let listeners = []\n      event.target = flow\n      flow.on.listenerMap[event.name()]\n        .forEach(listener=>{\n          let l = {\n            listener\n          }\n          listeners.push(l)\n          if (event.status() != STATUS.FLOWING) {\n            l.status = event.status()\n            return;\n          }\n          if (event.stopPropagation.modifiers[flow.guid.value]\n            & DIRECTION_BITMASK['CURRENT']) {\n            l.status = 'SKIPPED'\n            return;\n          }\n          l.status='DELIVERED'\n          listener.apply(event, event.data.value)\n          \n        })\n      return {\n        flow,\n        listeners\n      }\n    }\n  }\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/behaviours/listen.js\n **/","import {serialise} from '../utils'\nexport default (flow)=>{\n  flow.toString = () => {\n    return JSON.stringify(flow.toObj())\n  }\n\n  flow.toObj = (...args) => {\n    const props = args.reduce((a,b)=>(a[b]=1,a),{})\n    const hasProp = prop=>!args.length || props[prop]\n    const add = (name, valueF)=>{if(hasProp(name)) obj[name]=valueF() }\n    let obj = {}\n\n    add('name',   flow.name)\n    add('guid',   flow.guid)\n    add('version',()=>flow.version)\n    add('status', flow.status)\n    add('data',   ()=>serialise(flow.data()))\n    add('parent', ()=>({\n      name: flow.parent.value && flow.parent.value.name.value,\n      guid: flow.parent.value && flow.parent.value.guid.value\n    }))\n    add('listeners', ()=>{\n      const l = flow.on()\n      let o = {}\n      Object.keys(l)\n        .forEach(key=>o[key]=l[key]\n          .map(f=>f.name||'function'))\n      return o;\n    })\n    add('children', ()=>flow.children()\n      .map(f=>f.toObj('name','guid')))\n\n    add('recipients', ()=>{\n      return flow.emit.recipients \n      && flow.emit.recipients.map(f=>({\n        flow: f.flow.toObj('name','guid'),\n        route: f.route.map(f=>({\n          flow: f.flow.toObj('name','guid'),\n          direction: f.direction\n        })),\n        listeners: f.listeners.map(l=>({\n          name: serialise(l.listener),\n          status:l.status\n        }))\n      }))\n    })\n    return obj;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/behaviours/loggable.js\n **/","import logger from '../logger'\nimport {assert, dispatchInternalEvent} from '../utils'\n\nexport default (flow, defaults, name, data)=>{\n    flow.data = (...data) => {\n    if (!data.length) {\n      return (flow.data.value.length<=1)\n        ? flow.data.value[0]\n        : flow.data.value\n      }\n    var oldData = flow.data.value\n    flow.data.value = data\n    dispatchInternalEvent(flow, 'data'\n      , (data.length>1?data:data[0])\n      , (oldData.length>1?oldData:oldData[0]))\n    return flow\n    }\n    flow.data.value = data\n  }\n\n\n/** WEBPACK FOOTER **\n ** ./src/behaviours/stateful.js\n **/","import { DEFAULTS\n       , ERRORS\n       , STATUS\n       , DIRECTION\n       , UNSET } from '../consts'\n\nimport logger from '../logger'\nimport {assert, dispatchInternalEvent} from '../utils'\n\nexport default (flow, defaults, name)=>{\n  \n \n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/behaviours/get.js\n **/","import logger from '../logger'\nimport {assert, dispatchInternalEvent} from '../utils'\nimport { DEFAULTS\n       , ERRORS\n       , DIRECTION\n       , UNSET } from '../consts'\n\n\nexport default (flow, defaults)=>{\n\n  flow.stats = (d) => {\n    if (d===undefined) return flow.stats.value\n    assert(typeof(d)!=='object'\n         , ERRORS.invalidStatsArgs)\n    let previousStats = flow.stats.value\n    flow.stats.value = {...flow.stats.value, ...d}\n    dispatchInternalEvent(flow, 'stats', flow.stats.value, previousStats)\n    return flow\n  }\n\n  flow.stats.value = {\n    ignore: false, // do not track this node\n    collapsed: false\n  }\n\n  flow.version = VERSION\n\n\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/behaviours/stats.js\n **/","import {assert, dispatchInternalEvent} from '../utils'\nimport { ERRORS } from '../consts'\n\n\nexport default (flow, defaults)=>{\n\n  flow.dispose = (...args) => {\n    assert(args.length\n         , ERRORS.invalidDisposeArgs)\n    if (flow.dispose.value == true) return;\n\n    //recursively(depth first) dispose all downstream nodes\n    flow.children().forEach(f=>f.dispose())\n\n    dispatchInternalEvent(flow, 'dispose', true)\n    flow.parent(null)\n    flow.dispose.value = true\n    flow.on.listenerMap = {}\n\n    return flow\n  }\n  flow.dispose.value = false\n\n\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/behaviours/disposable.js\n **/"],"sourceRoot":""}